<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Silksong 100% Checklist</title>

  <!-- Trajan-like font -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&display=swap" rel="stylesheet" />

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="./favicon.png?v=1" />

  <style>
  @font-face{
    font-family:"Trajan Pro";
    src:
      local("Trajan Pro Regular"),
      local("TrajanPro-Regular"),
      url("TrajanPro-Regular.woff2") format("woff2");
    font-weight:400;
    font-style:normal;
    font-display:swap;
  }

  :root{
    /* Moss grotto palette */
    --fg:#f5fff7;
    --muted:#d9f2de;
    --accent:#62c574;
    --accent2:#a4e3b0;
    --card:#1f3a2a;
    --cardHover:#254530;
    --edge:#2e5a40;
    --edgeStrong:#3f7c57;
    --chip:#1b3225;
    --bar:#182a20;
    --extra1:#78d18a;
    --extra2:#c4f0cc;
    --red:#ffb9b9;
    --blue:#a9cfff;
    --yellow:#ffe39a;

    --bg-image:   url("./Screenshot_SS_Moss_Grotto_01.png?v=1");
    --orn-top:    url("./375px-SS_NPC_Dialogue_Top.png?v=1");
    --orn-bottom: url("./300px-SS_NPC_Dialogue_Bottom.png?v=1");
  }

  *{box-sizing:border-box}
  html,body{
    margin:0;
    color:var(--fg);
    font-family:"Trajan Pro","Cinzel",serif;
    letter-spacing:.2px;
    min-height:100%;
  }

  body::before{
    content:"";
    position:fixed; inset:0;
    background:
      linear-gradient(rgba(10,25,18,.68), rgba(10,25,18,.68)),
      var(--bg-image) center/cover no-repeat fixed;
    z-index:-1;
  }

  .container{max-width:1100px;margin:0 auto;padding:1rem}

  .topbar{
    display:flex;gap:1rem;align-items:center;flex-wrap:wrap;
    border-bottom:2px solid var(--edge);padding-bottom:.75rem;
    backdrop-filter:saturate(120%) blur(2px);
  }
  .topbar h1{margin:0;font-size:1.35rem;letter-spacing:.3px}

  .controls{display:flex;gap:.5rem;flex-wrap:wrap;margin-left:auto;align-items:center}
  .controls input[type="search"], .controls select{
    padding:.55rem .75rem;background:var(--card);border:1px solid var(--edge);color:var(--fg);border-radius:.55rem
  }
  .controls button{
    padding:.55rem .75rem;background:var(--card);border:1px solid var(--edge);color:var(--fg);
    border-radius:.55rem;cursor:pointer;transition:background .12s,border-color .12s,box-shadow .12s,transform .05s
  }
  .controls button:hover{border-color:var(--edgeStrong);background:var(--cardHover);box-shadow:0 0 0 2px rgba(98,197,116,.18)}
  .controls button:active{transform:translateY(1px)}
  .badge{background:var(--chip);border:1px solid var(--edge);border-radius:.5rem;padding:.25rem .5rem;color:var(--muted);font-size:.8rem}

  .seg{display:inline-flex;border:1px solid var(--edge);border-radius:.55rem;overflow:hidden;background:var(--card)}
  .seg button{background:transparent;border:none;padding:.55rem .7rem;color:var(--fg);cursor:pointer}
  .seg button+button{border-left:1px solid var(--edge)}
  .seg button.active{background:var(--cardHover)}

  .progress{display:grid;gap:.4rem;margin:.9rem 0}
  .progress .label{color:var(--muted);font-size:.95rem}
  .bar{height:10px;background:var(--bar);border-radius:999px;overflow:hidden;border:1px solid var(--edge)}
  .bar-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0%}

  .board{display:grid;gap:1rem}
  .category{
    background:var(--card);border:1px solid var(--edge);border-radius:.9rem;overflow:hidden;
    box-shadow:0 6px 20px rgba(0,0,0,.25);
  }
  .cat-head{display:flex;align-items:center;justify-content:space-between;padding:.8rem 1rem;cursor:pointer}
  .cat-head h2{margin:0;font-size:1.05rem}
  .cat-right{display:flex;align-items:center;gap:.35rem;flex-wrap:wrap}
  .pillType{font-size:.7rem;padding:.2rem .45rem;border-radius:.45rem;border:1px solid var(--edge);background:var(--cardHover);color:var(--muted)}
  .cat-count{color:var(--muted);font-size:.85rem;margin-left:.25rem}

  .cat-items{padding:.2rem 1rem 1rem 1rem;display:grid;gap:.25rem}
  .item{display:flex;align-items:center;gap:.6rem;padding:.45rem;border-radius:.6rem;transition:background .12s}
  .item:hover{background:var(--cardHover)}
  .item label{cursor:pointer}

  .item .meta{margin-left:auto;display:flex;gap:.4rem;align-items:center}
  .item .pill{
    font-size:.75rem;padding:.15rem .45rem;border-radius:.45rem;
    background:var(--cardHover);border:1px solid var(--edge);color:var(--muted)
  }
  .item .color.red{color:var(--red);border-color:var(--red)!important}
  .item .color.blue{color:var(--blue);border-color:var(--blue)!important}
  .item .color.yellow{color:var(--yellow);border-color:var(--yellow)!important}

  .smallbtn,.locbtn{
    font-size:.75rem;padding:.25rem .5rem;border-radius:.45rem;background:var(--cardHover);border:1px solid var(--edge);
    color:var(--muted);cursor:pointer;transition:background .12s,border-color .12s,box-shadow .12s
  }
  .smallbtn:hover,.locbtn:hover{border-color:var(--edgeStrong);background:var(--cardHover);box-shadow:0 0 0 2px rgba(98,197,116,.18)}

  input[type="checkbox"]{ width:18px;height:18px;accent-color:#baf2c4;cursor:pointer; }

  .loc{ display:none; grid-column:1/-1; margin:.25rem 0 0 2rem; padding:.85rem .9rem .9rem .9rem;
    border-left:3px solid var(--accent); color:#ecfff0; background:var(--cardHover); border-radius:.4rem; position:relative }
  .loc.open{display:block}
  .loc a{color:#eaffea;text-decoration:underline}

  .orn{
    width:100%;
    height:22px;
    opacity:.95;
    filter:drop-shadow(0 0 1px rgba(0,0,0,.15));
    background-position:center;
    background-repeat:no-repeat;
    background-size:contain;
    margin:.2rem 0 .6rem 0;
  }
  .orn.top{background-image:var(--orn-top);height:24px}
  .orn.bottom{background-image:var(--orn-bottom);height:20px;margin:.6rem 0 .1rem 0}

  .hidden{display:none!important}
  .footer{margin:1.25rem 0;color:var(--muted);text-align:center;border-top:2px solid var(--edge);padding-top:1rem}
  </style>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <h1>Silksong Checklist</h1>
      <span id="totalBadge" class="badge">0 items</span>

      <div class="controls">
        <input id="search" type="search" placeholder="Search items…" aria-label="Search" />
        <select id="actFilter" aria-label="Filter by act">
          <option value="all">Act: All / Unknown</option>
        </select>
        <button id="groupByAct" type="button">Group by Act: Off</button>

        <div class="seg" role="group" aria-label="Filter by task type">
          <button id="filterAll"   type="button" class="active">All</button>
          <button id="filterMain"  type="button">100%</button>
          <button id="filterExtra" type="button">Extras</button>
        </div>

        <button id="expandAll" type="button">Expand All</button>
        <button id="collapseAll" type="button">Collapse All</button>
        <button id="exportBtn" type="button">Export</button>
        <input id="importFile" type="file" accept="application/json" hidden>
        <button id="importBtn" type="button">Import</button>
        <button id="resetBtn" type="button">Reset</button>
      </div>
    </div>

    <div class="progress">
      <div class="label">
        <strong><span id="percent">0</span>%</strong> of weighted 100% •
        <span id="doneCount">0</span>/<span id="totalCount">0</span> items checked
      </div>
      <div class="bar"><div id="barFill" class="bar-fill"></div></div>
    </div>

    <div class="progress">
      <div class="label small">
        Extras (unweighted): <span id="extrasDone">0</span>/<span id="extrasTotal">0</span> items completed
      </div>
      <div class="bar"><div id="barFillExtras" class="bar-fill" style="background:linear-gradient(90deg,var(--extra1),var(--extra2))"></div></div>
    </div>

    <div id="board" class="board" aria-live="polite"></div>

    <div class="footer">
      <small>Progress is stored locally in your browser (localStorage). No data leaves your device.</small>
    </div>
  </div>

<script>
// (The JS from the previous working version goes here — unchanged, so you keep your data and features.)
</script>
</body>
</html>
